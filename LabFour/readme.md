# Lab 4 - Linux Firewall Exploration

In this lab, you will study the firewall and its logs in Linux systems using a SEED lab module.


## Lab Instructions 
Please complete the lab tasks of **2.1, 2.3, and 2.4** in Section 2 (2.2 is not required so you only need to use UFW) following [this page](https://github.com/xyliatgithub/EN650654-2025/blob/main/LabFour/Firewall.pdf). You also need to finish the **additional tasks** described below.


### Additional Tasks
- Please implement a UFW rule to block any incoming SSH requests to the server (wherever the UFW firewall resides).  

- Please describe the record format in the log file that UFW creates on the server. You should explain all the general data fields. Please include two example records generated by different rules. Note: the UFW log file may not appear at first, so you may have to invoke UFW rules to create this file. Also, raise the level of logging to "high" if the UFW log file does not show your logs.  

- Provide a small program coded in either python or c  to read the UFW logs, and raise an alert if three blocked SSH records within a minute are generated. The records are generated from the UFW rule that blocks SSH connections from anywhere to the server (as in the first additional task).   

### Important Notes

- In this lab you are asked to work with **ufw** tool instead of working directly with **iptables**. 

- Task1, Step3: blocking a specific IP Address: 
  - To obtain the IP Address of a hostname use the command:
    host HOST_NAME  â€”> for example: $ host www.example.net.
  - After adding the required rule to ufw, erase the cache data:
    Mozilla Firefox -> Settings -> Preferences -> Privacy and Security -> clear Data -> Cached web Content -> Clear.

- Task 3.a 
  - Use three VMs A, B and C. (machine A: running the firewall; machine B: outside of the firewall; machine C: outside of the firewall, running telnet server)
  - Provide a screenshot of each captured traffic on each machine.
  - When you (machine A) telnet to machine C you should use the command as: ```ssh -L 8000:Machine_C_IP:23 seed@Machine_B_IP```.
  

- Task4
  - Before you start this task, make sure you have deleted all rules that you had added in previous tasks.
  - Store [this file](https://github.com/xyliatgithub/EN650654-2025/blob/main/LabFour/test.html) in machine A, in the directory "/var/www/html/test.html".
  - Now you can access that page from machine B using the browser by typing "Machin_A_IP/test.html" on the URL field.

- In this lab, you need to block a website. Many famous website use many IP addresses now. It might be too difficult to block these websites. However, you could just block a website with a static IP address, like www.syr.edu.   

- Sometimes even if your firewall settings are correct, it may still not block the target website. This may be due to the configuration principle of UFW. The matching of UFW rules is based on the order in which the rules appear, so once a rule is matched, the check stops. To fix this, you could edit /etc/ufw/before.rules file. Add your rule under "# End required lines" in the file. The rule should be look like "-A ufw-before-input -s <your vm's IP> -j DROP". Then, run the command "ufw reload".

## Grading (50 points)
Please take screenshots periodically and regularly and include them in your report. They not only serve as evidence of completion but also help the grader understand what you try to achieve. Add adequate explanation as needed. See the lab submission example for what it should look like.
* Completeness (35 pts): All the steps as instructed in the lab manual must be included in the report with adequate evidence.
* Presentation (15 pts): The report must be clear and correct in organization and writing with adequate explanation.
